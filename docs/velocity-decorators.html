<html>
    <head>
        <title>Velocity Decorators</title>
    </head>

    <body>
        As of SiteMesh 2.0.2 <a href="http://jakarta.apache.org/velocity/">Velocity</a> (.vm)
        decorators are supported.

        <p>Here is an example of how such a decorator might look:</p>

<pre style="border: 1px solid #999999; padding: 5px">
#parse ("/includes/decorators/header.vm")
    &lt;h2&gt;<b>$title</b>&lt;/h2&gt;
    <b>$head</b>
    &lt;img src="<b>$base</b>/images/logo.gif" border="0"&gt;
    &lt;td valign="top" class="body"&gt;
        &lt;div class="header"&gt;
            &lt;span class="pagetitle"&gt;<b>$title</b>&lt;/span&gt;
        &lt;/div&gt;
        <b>$body</b>
    &lt;/td&gt;
#parse ("/includes/decorators/footer.vm")
</pre>

        <h3>Installation</h3>
        
        <p>Download <a href="http://jakarta.apache.org/velocity/">Velocity</a> 1.3 or higher and put it on the classpath.
        The SiteMesh distribution comes with <b>velocity-1.4-rc1.jar</b>.</p>

        <p>Add the following to <b><code>[web-app]/WEB-INF/web.xml</code></b>
        within the <b><code>&lt;web-app&gt;</code></b> tag:</p>

<pre style="border: 1px solid #999999; padding: 5px">
&lt;servlet&gt;
    &lt;servlet-name&gt;<b>sitemesh-velocity</b>&lt;/servlet-name&gt;
    &lt;servlet-class&gt;<b>com.opensymphony.module.sitemesh.velocity.VelocityDecoratorServlet</b>&lt;/servlet-class&gt;
&lt;/servlet&gt;

&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;sitemesh-velocity&lt;/servlet-name&gt;
    &lt;url-pattern&gt;<b>/decorators/*.vm</b>&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
</pre>

		<p>Now you can reference any .vm under the decorators directory from your decorators.xml.</p>
		
		<h3>Context</h3>
		
		VelocityDecoratorServlet puts some things into the context object that you should be aware of: 
		
		<table border="0" cellspacing="10">
		    <tr>
		        <td valign="top"><strong>$req</strong> (from <a href="http://jakarta.apache.org/velocity/api/org/apache/velocity/servlet/VelocityServlet.html">VelocityServlet</a>)</td>
		        <td>The HttpServletRequest object</td>
		    </tr>
		    <tr>
		        <td valign="top"><strong>$res</strong> (from <a href="http://jakarta.apache.org/velocity/api/org/apache/velocity/servlet/VelocityServlet.html">VelocityServlet</a>)</td>
		        <td>The HttpServletResponse object</td>
		    </tr>
		    <tr>
		        <td valign="top"><strong>$base</strong></td>
		        <td>request.getContextPath()</td>
		    </tr>
		    <tr>
		        <td valign="top"><strong>$title</strong></td>
		        <td>Parsed page title (&lt;title&gt;...&lt;title&gt;)</td>
		    </tr>
		    <tr>
		        <td valign="top"><strong>$head</strong></td>
		        <td>Parsed page head</td>
		    </tr>
		    <tr>
		        <td valign="top"><strong>$body</strong></td>
		        <td>Parsed page body</td>
		    </tr>
		    <tr>
		        <td valign="top"><strong>$page</strong></td>
		        <td>SiteMesh's internal Page object</td>
		    </tr>
		</table>
	</body>
</html>